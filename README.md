 # AI全功能营销系统 - 详细功能说明文档

## 项目概述

**AI全功能营销系统**本项目是一个基于 Windows 平台的微信多功能工具与 AI 助手综合应用，集成了微信消息收发、删除好友、检测僵尸粉、联系人导出、聊天记录聚合保存、指定回复好友消息、联系人与群成员读取、批量/定时群发、自动化加好友、备注管理、消息监听与解析、自动回复（规则与 AI）、以及完整的 AI 助手（对话/文案优化/文档总结）等功能。为营销人员提供一站式的微信营销解决方案。

### 核心特色
- **AI智能化**：集成OpenAI、Claude、Google、SiliconFlow等多家AI厂商
- **全自动化**：消息监听、自动回复、定时群发、批量操作
- **现代界面**：基于PySide6的现代化GUI设计，操作简单直观
- **高度可配**：丰富的配置选项，支持个性化定制
- **数据导出**：支持联系人、聊天记录、统计数据的多格式导出
- **安全稳定**：单实例运行、异常处理、数据备份机制

---

## 关键功能详解

### 1) 账号与联系人/群管理
- 自动检测已登录账号（多进程支持）。
- 读取联系人信息（过滤系统账号/公众号/文件传输助手等）。
- 获取群列表与群成员明细（含昵称），支持批量处理。
- 列表搜索、右键菜单动作、导出为 Excel/CSV。

### 2) 消息收发
- 文本与图片消息发送（个人与群聊）。
- 失败回退（图片失败时回退成“文件路径”文本消息）。
- 统一失败处理提示与日志记录。

### 3) 消息监听与解析
- Frida Hook 指定函数偏移，解析 RDI/R9 等寄存器结构读取消息字段。
- XML 特殊消息解析：语音/图片/视频/文件/链接/位置/红包/转账/表情/音乐等。
- 群聊消息附带 `member_id` 便于明确发言人。

### 4) 自动回复系统
- 规则引擎：
  - 规则项（关键词→固定回复）增删改查，启用开关，导入导出。
  - 匹配模式：模糊匹配/精确匹配。
  - 场景：好友/群、指定好友/群、新好友欢迎、最小-最大间隔。
- AI 回复：
  - 大模型直答：系统提示、风格、表情、温度、token 限制可配置。
  - 元宝客服：把消息转发到指定客服微信，记录映射以便后续回发（当前实现等待 10s 后返回空串，不主动回填答案，建议配合监听扩展）。

### 5) 批量与定时任务
- 群发计划：
  - 选择好友/群、设置消息/图片与时间窗，定时执行。
  - 发送间隔随机化（最小/最大延迟）。
  - 任务表展示、编辑、删除、执行与刷新。

### 6) 加好友与备注管理
- 通过 wxid/手机号添加好友：内置流程调用微信内部接口，支持问候语与场景值。
- 批量添加群成员为好友。
- 修改好友备注：
  - UI 交互与静默修改两种方式（直接调用内部函数）。
  - 根据“通过好友申请”的昵称应用备注。

### 7) AI 助手
- 对话与文案优化：多风格、多版本并行生成。
- 文档总结：支持 txt/docx/xlsx/pdf（pdf 直接交由模型分析）。
- 多厂商/多模型：`config/api.json` 可扩展服务商与模型，支持切换与参数设置。
- 历史记录：保存在 INI 文件，便于轻量与可读。

### 8) 数据持久化与导出
- `config/api.json`：服务商列表、当前服务商与模型配置。
- `config/prompts.json`：提示词模板集合。
- `config/auto_reply_rules.json`：自动回复规则与 AI 设置（settings）。
- `config/messages.ini`：聊天历史（INI 结构，按时间排序）。
- 导出：联系人/群成员/历史为 Excel 或 CSV。

### 9) 统计与监控
- 消息统计：消息数、AI 回复数、自动回复数、错误数、响应时间列表。
- 监听状态：是否活跃、心跳检查与错误重试提示。

---

## 典型工作流

### 自动回复（AI 直答）
1. 启动消息监听 → 捕获消息 → 规则匹配（命中固定回复）或触发 AI 回复。
2. 生成 `system + user` 的提示词 → 调用当前服务商 `/chat/completions` → 拿到内容。
3. 记录与展示 → 发送回微信（防刷间隔控制）。

### 自动回复（元宝客服）
1. 监听消息 → 触发“元宝客服”模式 → 把用户内容直接发送给客服 wxid。
2. 记录最近发送者与群聊映射（便于后续回发）。
3. 当前实现等待一段时间并返回空串（不额外提示）；可二次开发监听客服回复并转发给用户。

### AI 文案优化（多版本并行）
1. 弹窗设置（风格/字数/表情/创意/保意/版本数）。
2. 并行构造多个提示词角度（价值/体验/表达/共鸣/实用），并行请求模型。
3. UI 汇总展示，支持复制。

- 【开发中】语音对话（STT/TTS）
  - 目标：支持麦克风实时语音识别（STT）→ 大模型对话 → 语音合成播报（TTS）。
  - 方案：
    - STT 计划接入 Whisper API 或离线引擎（需新增依赖与权限）。
    - TTS 计划首选云端 API，后续补离线方案。
  - 现状：代码中暂无 STT/TTS 实现与依赖，仅保留规划占位与参数位。

- 【规划中】流程图/工作流
  - 目标：将常见业务流程（私信漏斗/拉群/活动报名/售后回访/话术A/B测试）以“工作流”定义并可视化，驱动自动化执行。
  - 方案草案：
    - 流程定义：JSON DSL（节点：触发/条件/动作；动作含：发送文本/图片、延迟、加好友、备注修改、导出等）。
    - 可视化：基于 Qt GraphicsView 或 WebView 方案择优。
    - 执行器：新建 `workflow.py`，后台线程按节点流转、记录日志、可暂停/继续/重试。

- 【开发中】AI 图片生成
  - 目标：根据文案或提示词快速生成营销配图（海报/商品图/朋友圈图）。
  - 方案：
    - 首期接入云端图片生成 API（如 DALL·E / 可用的开源 API 网关）。
    - UI：在 `AIAssistantTab` 新增“图片生成”页签（尺寸/风格/批量数），生成后可一键复制/保存/发送到微信。
  - 现状：代码未包含图片生成 API 调用与 UI，属于新增模块。

- 【增强中】每日任务安排
  - 目标：结合“定时群发”能力，提供“每日任务面板”（今日待办/已办/逾期、执行日志、智能建议）。
  - 方案：
    - 复用 `TaskTab` 的定时器与任务表，增加“日视图/周视图”筛选与快捷创建。
    - 新增“AI 建议”按钮：根据历史互动/活动周期，建议推送时间窗与内容模板。
  - 现状：目前已有定时群发与随机间隔，可作为每日计划的基础；面板与建议功能待补充。

- 【规划中】浏览器爬虫数据
  - 目标：抓取目标页面（电商详情/活动页/新闻/社媒）结构化要点，生成可用卖点与配文草案。
  - 方案：
    - 受限于 Windows 桌面应用与合规考虑，优先提供“粘贴 URL → 模型总结页面核心信息”的轻量路径；
    - 可选提供简单的 `requests` 抓取（对动态站点再评估 Selenium 依赖）。
  - 现状：未实现爬虫与解析，仅在提示词层面支持“根据给定文本生成要点与话术”。

- 【AI/微信其他功能（可选项）】
  - 自动欢迎语 A/B 测试、群内@定向回复、基于画像的回复风格切换、活动报名表（xlsx）自动跟进模板等。
  - 多账号协同：在 `WeChatAccountService` 基础上做账号池与熔断策略（登录态/风控评估需谨慎）。

---

## 使用教程补充（含新增能力的操作建议）

- 【上传文档→话术生成】
  1) 打开“AI 助手”页，选择“文档总结”。
  2) 选择 txt/docx/xlsx/pdf 文件，设置“输出字数/风格/场景”（如私信首轮/转化话术/异议处理）。
  3) 点击生成，结果在右侧输出区域。建议复制保存为 md/json 到 `config/playbooks/`（后续版本将自动落盘）。
  4) 在“自动回复”页可将“话术片段”加入规则词；或在“任务/群发”中选择模板一键发送。

- 【语音对话（规划预热）】
  - 目前可用替代方案：使用第三方录音工具将语音转文字，粘贴到“AI 对话”输入框；AI 回复后自行用 TTS 软件朗读。
  - 等待内置 STT/TTS 集成后，将增加“语音输入/播报”开关与设备选择。

- 【流程图/工作流（规划预热）】
  - 现阶段建议用“任务/群发 + 自动回复规则”组合模拟：
    - 定时推送 → 等待回复 → 关键词命中分流（发送不同内容/拉群/备注修改）。
  - 后续上线工作流编辑器后，可将该组合迁移为可视化节点。

- 【AI 图片生成（待上线）】
  - 现阶段替代：将“文案”复制到云端图像生成网站，保存结果后回到应用内选择图片发送。
  - 上线后会在“AI 助手”新增页签，支持批量生成与一键发送。

- 【每日任务安排（增强中）】
  - 现有：在“任务/群发”中创建每日固定时间的计划，设置最小/最大随机间隔即可。
  - 即将提供：日/周视图切换、已办/逾期标记、执行统计与 AI 建议按钮。

- 【浏览器爬虫数据（规划预热）】
  - 现阶段替代：复制网页可见文本到“AI 对话/文案优化”，让模型总结卖点与配文。
  - 上线后将支持“粘贴 URL → 抓取与提炼”，并提示合规注意事项。

---

## 快速上手
- 步骤概览：
  1) 登录微信；以管理员运行应用。
  2) 在“AI 助手”页配置服务商与 API Key，测试连接保存。
  3) 在“自动回复”页配置规则或启用 AI 回复模式。
  4) 开启消息监听，观察自动回复效果。
  5) 需要群发/定时发送时，在任务页创建计划并执行。

- 配置文件位置：均位于 `config/` 目录，可手工备份/迁移。

---

## 免责声明

使用本项目则表示您同意并认可以下声明

1. 使用目的
本项目仅供学习交流使用，请勿用于非法用途，请勿用于非法用途，请勿用于非法用途，否则后果自负。
用户理解并同意，任何违反法律法规、侵犯他人合法权益的行为，均与本项目及其开发者无关，后果由用户自行承担。
2. 使用期限
您应该在下载保存，编译使用本项目的24小时内，删除本项目的源代码和（编译出的）程序；超出此期限的任何使用行为，一概与本项目及其开发者无关。
3. 操作规范
本项目仅允许在授权情况下对数据库进行备份与查看，严禁用于非法目的，否则自行承担所有相关责任；用户如因违反此规定而引发的任何法律责任，将由用户自行承担，与本项目及其开发者无关。
严禁用于窃取他人隐私，严禁用于窃取他人隐私，严禁用于窃取他人隐私，否则自行承担所有相关责任。
严禁进行二次开发，严禁进行二次开发，严禁进行二次开发，否则自行承担所有相关责任。
4. 免责声明接受
下载、保存、进一步浏览源代码或者下载安装、编译使用本程序，表示你同意本警告，并承诺遵守它;
5. 禁止用于非法测试或渗透
禁止利用本项目的相关技术从事非法测试或渗透，禁止利用本项目的相关代码或相关技术从事任何非法工作，如因此产生的一切不良后果与本项目及其开发者无关。
任何因此产生的不良后果，包括但不限于数据泄露、系统瘫痪、侵犯隐私等，均与本项目及其开发者无关，责任由用户自行承担。
6. 免责声明修改
本免责声明可能根据项目运行情况和法律法规的变化进行修改和调整。用户应定期查阅本页面以获取最新版本的免责声明，使用本项目时应遵守最新版本的免责声明。
7. 其他
除本免责声明规定外，用户在使用本项目过程中应遵守相关的法律法规和道德规范。对于因用户违反相关规定而引发的任何纠纷或损失，本项目及其开发者不承担任何责任。

请用户慎重阅读并理解本免责声明的所有内容，确保在使用本项目时严格遵守相关规定。
